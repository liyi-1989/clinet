png("rcd.png")
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = T)
lines(arc,col="yellow")
}
dev.off()
png("cor.png")
par(mfrow=c(1,1))
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el1[,1],el1[,2])),4],y=dfv[unique(c(el1[,1],el1[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el1[i,1],]
node2=dfv[dfv[,1]==el1[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = T)
lines(arc,col="yellow")
}
dev.off()
png("rcd.png")
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = T)
lines(arc,col="yellow")
}
dev.off()
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = F)
lines(arc,col="yellow")
}
cbind(el1,el2)
dfv[859,]
dfv[1518,]
plot(X1[,859],X1[,1518])
plot(X1[,859],X1[,1554])
plot(X[24,31,],X[43,6,])
plot(X[24,31,],X[44,6,])
plot(X[24,31,],X[45,6,])
plot(X[24,31,],X[46,6,])
plot(X[24,31,],X[47,6,])
plot(X[24,31,],X[48,6,])
plot(X[24,31,],X[49,6,])
plot(X[24,31,],X[50,6,])
plot(X[24,31,],X[50,7,])
plot(X[24,31,],X[50,8,])
plot(X[24,31,],X[50,9,])
plot(X[24,31,],X[50,5,])
plot(X[24,31,],X[50,6,])
plot(X[24,31,],X[43,6,])
plot(X[24,31,],X[43,5,])
library(rhdf5)
fileloc="./data/air_mon_mean.nc"
h5ls(fileloc)
# group name       otype dclass            dim
# 0     /  air H5I_DATASET  FLOAT 144 x 73 x 830
# 1     /  lat H5I_DATASET  FLOAT             73
# 2     /  lon H5I_DATASET  FLOAT            144
# 3     / time H5I_DATASET  FLOAT            830
LON=h5read(fileloc,"lon")
LAT=h5read(fileloc,"lat")
X=h5read(fileloc,"air") # lon*lat*time unit degC
NLON=length(LON)
NLAT=length(LAT)
LAT=rev(LAT)
LON=c(LON[(NLON/2+1):NLON]-360,LON[1:(NLON/2)])
X=X[, length(LAT):1, ]
X=X[c((NLON/2+1):NLON,1:(NLON/2)),,]
X=X[,,1:(dim(X)[3]-2)] # 1948-2016
plot(X[24,31,],X[43,6,])
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
net1=graph_from_adjacency_matrix((abs(S1)>0.65)*(!S0),mode = "undirected")
layout=layout.circle(net1)
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,232],X1[,778])
# https://www.darrinward.com/lat-long/?id=3104911
thres=5
#S0=nn_ind(NLON,NLAT,round(thres*NLON/NLAT),thres)
net2=graph_from_adjacency_matrix((S2>0.27)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el1
el2=as_edgelist(net2)
el2
dim(e1)
dim(el1)
dim(el2)
net1=graph_from_adjacency_matrix((abs(S1)>0.6)*(!S0),mode = "undirected")
el1=as_edgelist(net1)
dim(el1)
net1=graph_from_adjacency_matrix((abs(S1)>0.59)*(!S0),mode = "undirected")
layout=layout.circle(net1)
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,232],X1[,778])
# https://www.darrinward.com/lat-long/?id=3104911
thres=5
#S0=nn_ind(NLON,NLAT,round(thres*NLON/NLAT),thres)
net2=graph_from_adjacency_matrix((S2>0.28)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
net1=graph_from_adjacency_matrix((abs(S1)>0.595)*(!S0),mode = "undirected")
layout=layout.circle(net1)
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,232],X1[,778])
# https://www.darrinward.com/lat-long/?id=3104911
thres=5
#S0=nn_ind(NLON,NLAT,round(thres*NLON/NLAT),thres)
net2=graph_from_adjacency_matrix((S2>0.285)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
net1=graph_from_adjacency_matrix((abs(S1)>0.597)*(!S0),mode = "undirected")
layout=layout.circle(net1)
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,232],X1[,778])
# https://www.darrinward.com/lat-long/?id=3104911
thres=5
#S0=nn_ind(NLON,NLAT,round(thres*NLON/NLAT),thres)
net2=graph_from_adjacency_matrix((S2>0.284)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
n1=graph_from_edgelist(el1)
n2=graph_from_edgelist(el2)
layout=layout.circle(n1)
layout=layout.circle(n2)
plot(n1, layout=layout,vertex.size=0.01,edge.arrow.size=0)
plot(n2, layout=layout,vertex.size=0.01,edge.arrow.size=0)
el1
cbind(el1,el2)
par(mfrow=c(1,2))
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,805],X1[,2467])
plot(X1[,859],X1[,1518])
plot(X[24,31,],X[43,6,])
plot(X1[,859],X1[,1554])
library("maps")
library("geosphere")
png("cor.png")
par(mfrow=c(1,1))
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el1[,1],el1[,2])),4],y=dfv[unique(c(el1[,1],el1[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el1[i,1],]
node2=dfv[dfv[,1]==el1[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = T)
lines(arc,col="yellow")
}
dev.off()
png("rcd.png")
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = F)
lines(arc,col="yellow")
}
dev.off()
rcd(X1[,859],X1[,1518])
rcd(X1[,859],X1[,1518],method = "kde")
net1=graph_from_adjacency_matrix((abs(S1)>0.56)*(!S0),mode = "undirected")
layout=layout.circle(net1)
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,232],X1[,778])
# https://www.darrinward.com/lat-long/?id=3104911
thres=5
#S0=nn_ind(NLON,NLAT,round(thres*NLON/NLAT),thres)
net2=graph_from_adjacency_matrix((S2>0.26)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
sum(S1*S0)
sum(S1*S0>0)
100/sum(S1*S0>0)
1-100/sum(S1*S0>0)
quantile(abs(S1),1-100/sum(S1*S0>0))
quantile(abs(S2),1-100/sum(S2*S0>0))
quantile(abs(S2),1-100/sum((S2*S0)>0))
quantile(abs(S2),1-100/sum((S2*!S0)>0))
net1=graph_from_adjacency_matrix((abs(S1)>0.555)*(!S0),mode = "undirected")
layout=layout.circle(net1)
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,232],X1[,778])
# https://www.darrinward.com/lat-long/?id=3104911
thres=5
#S0=nn_ind(NLON,NLAT,round(thres*NLON/NLAT),thres)
net2=graph_from_adjacency_matrix((S2>0.254)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
net1=graph_from_adjacency_matrix((abs(S1)>0.556)*(!S0),mode = "undirected")
layout=layout.circle(net1)
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,232],X1[,778])
# https://www.darrinward.com/lat-long/?id=3104911
thres=5
#S0=nn_ind(NLON,NLAT,round(thres*NLON/NLAT),thres)
net2=graph_from_adjacency_matrix((S2>0.257)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
net1=graph_from_adjacency_matrix((abs(S1)>0.5565)*(!S0),mode = "undirected")
layout=layout.circle(net1)
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,232],X1[,778])
# https://www.darrinward.com/lat-long/?id=3104911
thres=5
#S0=nn_ind(NLON,NLAT,round(thres*NLON/NLAT),thres)
net2=graph_from_adjacency_matrix((S2>0.258)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
net1=graph_from_adjacency_matrix((abs(S1)>0.5565)*(!S0),mode = "undirected")
layout=layout.circle(net1)
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,232],X1[,778])
# https://www.darrinward.com/lat-long/?id=3104911
thres=5
#S0=nn_ind(NLON,NLAT,round(thres*NLON/NLAT),thres)
net2=graph_from_adjacency_matrix((S2>0.2575)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
net2=graph_from_adjacency_matrix((S2>0.2577)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
net2=graph_from_adjacency_matrix((S2>0.2578)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
net2=graph_from_adjacency_matrix((S2>0.2579)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
net2=graph_from_adjacency_matrix((S2>0.25795)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
dim(el1)
dim(el2)
net1=graph_from_adjacency_matrix((abs(S1)>0.5565)*(!S0),mode = "undirected")
layout=layout.circle(net1)
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(X1[,232],X1[,778])
# https://www.darrinward.com/lat-long/?id=3104911
thres=5
#S0=nn_ind(NLON,NLAT,round(thres*NLON/NLAT),thres)
net2=graph_from_adjacency_matrix((S2>0.25795)*(!S0),mode = "undirected")
layout=layout.circle(net2)
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
el1=as_edgelist(net1)
el2=as_edgelist(net2)
n1=graph_from_edgelist(el1)
n2=graph_from_edgelist(el2)
layout=layout.circle(n1)
layout=layout.circle(n2)
plot(n1, layout=layout,vertex.size=0.01,edge.arrow.size=0)
plot(n2, layout=layout,vertex.size=0.01,edge.arrow.size=0)
par(mfrow=c(1,2))
plot(net1, layout=layout, vertex.size=0.1,vertex.label=NA, vertex.frame.color="blue",vertex.color="blue",
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
plot(net2, layout=layout, vertex.size=0.01,vertex.label=NA,
vertex.frame.color=rgb(0,0,1,alpha = 0.1),vertex.color=rgb(0,0,1,alpha = 0.1),
edge.arrow.size=0,edge.color=rgb(0.5,0.5,0.5,alpha = 0.1))
png("cor.png")
par(mfrow=c(1,1))
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el1[,1],el1[,2])),4],y=dfv[unique(c(el1[,1],el1[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el1[i,1],]
node2=dfv[dfv[,1]==el1[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = T)
lines(arc,col="yellow")
}
dev.off()
png("rcd.png")
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = F)
lines(arc,col="yellow")
}
dev.off()
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = F,breakAtDateLine=T)
lines(arc,col="yellow")
}
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = F,breakAtDateLine=F)
lines(arc,col="yellow")
}
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=10,addStartEnd = F,breakAtDateLine=F)
lines(arc,col="yellow")
}
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=10,addStartEnd = F,breakAtDateLine=F)
lines(arc,col="yellow")
}
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=10,addStartEnd = F,breakAtDateLine=T)
lines(arc,col="yellow")
}
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=10,addStartEnd = F,breakAtDateLine=F)
lines(arc,col="yellow")
}
map("world",col="skyblue",border="gray10",fill=T,bg="gray30")
points(x=dfv[unique(c(el2[,1],el2[,2])),4],y=dfv[unique(c(el2[,1],el2[,2])),5],col="orange",pch=19)
for(i in 1:nrow(el1)){
node1=dfv[dfv[,1]==el2[i,1],]
node2=dfv[dfv[,1]==el2[i,2],]
arc=gcIntermediate(c(node1[4],node1[5]),c(node2[4],node2[5]),n=1000,addStartEnd = F,breakAtDateLine=F)
lines(arc,col="yellow")
}
cbind(el1,el2)
plot(X1[,805],X1[,2503])
plot(X1[,805],X1[,2431])
dfv[805,]
dfv[2431,]
plot(X[68,19,],X[155,0,])
plot(X[23,13,],X[68,19,])
plot(X1[,805],X1[,2431])
plot(X[23,13,],X[68,19,])
library(rhdf5)
fileloc="./data/air_mon_mean.nc"
h5ls(fileloc)
# group name       otype dclass            dim
# 0     /  air H5I_DATASET  FLOAT 144 x 73 x 830
# 1     /  lat H5I_DATASET  FLOAT             73
# 2     /  lon H5I_DATASET  FLOAT            144
# 3     / time H5I_DATASET  FLOAT            830
LON=h5read(fileloc,"lon")
LAT=h5read(fileloc,"lat")
X=h5read(fileloc,"air") # lon*lat*time unit degC
NLON=length(LON)
NLAT=length(LAT)
LAT=rev(LAT)
LON=c(LON[(NLON/2+1):NLON]-360,LON[1:(NLON/2)])
X=X[, length(LAT):1, ]
X=X[c((NLON/2+1):NLON,1:(NLON/2)),,]
X=X[,,1:(dim(X)[3]-2)] # 1948-2016
plot(X[23,13,],X[68,19,])
library(rhdf5)
fileloc="./data/air_mon_mean.nc"
h5ls(fileloc)
# group name       otype dclass            dim
# 0     /  air H5I_DATASET  FLOAT 144 x 73 x 830
# 1     /  lat H5I_DATASET  FLOAT             73
# 2     /  lon H5I_DATASET  FLOAT            144
# 3     / time H5I_DATASET  FLOAT            830
LON=h5read(fileloc,"lon")
LAT=h5read(fileloc,"lat")
X=h5read(fileloc,"air") # lon*lat*time unit degC
NLON=length(LON)
NLAT=length(LAT)
LAT=rev(LAT)
LON=c(LON[(NLON/2+1):NLON]-360,LON[1:(NLON/2)])
X=X[, length(LAT):1, ]
X=X[c((NLON/2+1):NLON,1:(NLON/2)),,]
X=X[,,1:(dim(X)[3]-2)] # 1948-2016
install.packages("rhdf5")
source("https://bioconductor.org/biocLite.R")
biocLite("rhdf5")
library(rhdf5)
fileloc="./data/air_mon_mean.nc"
h5ls(fileloc)
# group name       otype dclass            dim
# 0     /  air H5I_DATASET  FLOAT 144 x 73 x 830
# 1     /  lat H5I_DATASET  FLOAT             73
# 2     /  lon H5I_DATASET  FLOAT            144
# 3     / time H5I_DATASET  FLOAT            830
LON=h5read(fileloc,"lon")
LAT=h5read(fileloc,"lat")
X=h5read(fileloc,"air") # lon*lat*time unit degC
NLON=length(LON)
NLAT=length(LAT)
LAT=rev(LAT)
LON=c(LON[(NLON/2+1):NLON]-360,LON[1:(NLON/2)])
X=X[, length(LAT):1, ]
X=X[c((NLON/2+1):NLON,1:(NLON/2)),,]
X=X[,,1:(dim(X)[3]-2)] # 1948-2016
plot(X[23,13,],X[68,19,])
plot(X[24,31,],X[43,6,])
plot(X1[,859],X1[,1518])
plot(X[24,31,],X[43,6,])
plot(X1[,805],X1[,2431])
plot(X[23,13,],X[68,19,])
